import{_ as e}from"./index.vue_vue_type_script_setup_true_lang-BqlVyj9y.js";import{_ as l}from"./index-CtgtvX_q.js";import{a3 as a,d as t,M as d,f as o,c as s,g as u,o as r,a as i,w as c,j as m,i as n,h as f,F as v,l as p,H as _,$ as V}from"./index-PFxU9JJn.js";import{b as g}from"./category-DifXSo6-.js";import{u as h}from"./useResetReactive-C9BdlN97.js";function b(e){return a.get("/Article/getList",e)}function y(e){return a.post("/Article/delete",e)}const w=t({__name:"AddArticleModal",emits:["save-success"],setup(t,{expose:b,emit:y}){const w=y,x=d("formRef"),k=o(""),U=s((()=>!!k.value)),j=s((()=>U.value?"编辑文章分类":"新增文章分类")),A=o(!1),[q,M]=h({cover:"",desc:"",content:"",title:"",status:1,sort:0,recommend:0,category_id:""}),R={category_id:[{required:!0,message:"请选择文章分类"}],cover:[{required:!0,message:"请上传文章封面"}],title:[{required:!0,message:"请输入文章分类名称"},{min:3,max:10,message:"长度在 3 - 10个字符"}],desc:[{required:!0,message:"请输入文章分类名称"},{min:3,max:10,message:"长度在 3 - 10个字符"}],sort:[{required:!0,message:"请输入文章分类排序"}],status:[{required:!0}]},F=o([]);g().then((e=>{F.value=e.data}));const H=()=>{var e;null==(e=x.value)||e.resetFields(),M()},O=async()=>{var e,l;try{if(await(null==(e=x.value)?void 0:e.validate()))return!1;return!!(await(l=q,a.post("/Article/saveArticle",l)))&&(V.success("保存成功"),w("save-success"),!0)}catch(t){return!1}};return b({add:()=>{k.value="",A.value=!0},edit:async e=>{A.value=!0,k.value=e;const l=await(t={id:e},a.get("/Article/getDetail",t));var t;l.data.price=1*l.data.price,Object.assign(q,l.data)}}),(a,t)=>{const d=u("a-option"),o=u("a-select"),s=u("a-form-item"),V=l,g=u("a-input"),h=u("a-input-number"),b=u("a-switch"),y=e,w=u("a-form"),k=u("a-modal");return r(),i(k,{visible:n(A),"onUpdate:visible":t[8]||(t[8]=e=>_(A)?A.value=e:null),title:n(j),width:"90%","mask-closable":!1,"unmount-on-close":"","modal-style":{maxWidth:"55vW",maxHeight:"70vh",overflowY:"auto"},onBeforeOk:O,onClose:H},{default:c((()=>[m(w,{ref_key:"formRef",ref:x,model:n(q),rules:R,size:"medium","auto-label-width":""},{default:c((()=>[m(s,{label:"所属分类",field:"category_id"},{default:c((()=>[m(o,{placeholder:"请选择分类",modelValue:n(q).category_id,"onUpdate:modelValue":t[0]||(t[0]=e=>n(q).category_id=e)},{default:c((()=>[(r(!0),f(v,null,p(n(F),(e=>(r(),i(d,{value:e.value,label:e.label},null,8,["value","label"])))),256))])),_:1},8,["modelValue"])])),_:1}),m(s,{label:"文章封面",field:"cover"},{default:c((()=>[m(V,{modelValue:n(q).cover,"onUpdate:modelValue":t[1]||(t[1]=e=>n(q).cover=e)},null,8,["modelValue"])])),_:1}),m(s,{label:"文章标题",field:"title"},{default:c((()=>[m(g,{modelValue:n(q).title,"onUpdate:modelValue":t[2]||(t[2]=e=>n(q).title=e),modelModifiers:{trim:!0},placeholder:"请输入文章标题","allow-clear":""},null,8,["modelValue"])])),_:1}),m(s,{label:"文章简介",field:"desc"},{default:c((()=>[m(g,{modelValue:n(q).desc,"onUpdate:modelValue":t[3]||(t[3]=e=>n(q).desc=e),modelModifiers:{trim:!0},placeholder:"请输入文章简介","allow-clear":""},null,8,["modelValue"])])),_:1}),m(s,{label:"排序（小到大）",field:"sort"},{default:c((()=>[m(h,{modelValue:n(q).sort,"onUpdate:modelValue":t[4]||(t[4]=e=>n(q).sort=e),modelModifiers:{trim:!0},placeholder:"请输入排序（小到大）","allow-clear":""},null,8,["modelValue"])])),_:1}),m(s,{label:"状态",field:"status"},{default:c((()=>[m(b,{modelValue:n(q).status,"onUpdate:modelValue":t[5]||(t[5]=e=>n(q).status=e),type:"round","checked-value":1,"unchecked-value":0,"checked-text":"正常","unchecked-text":"禁用"},null,8,["modelValue"])])),_:1}),m(s,{label:"是否推荐",field:"recommend"},{default:c((()=>[m(b,{modelValue:n(q).recommend,"onUpdate:modelValue":t[6]||(t[6]=e=>n(q).recommend=e),type:"round","checked-value":1,"unchecked-value":0,"checked-text":"推荐","unchecked-text":"不推荐"},null,8,["modelValue"])])),_:1}),m(s,{label:"文章内容",field:"desc","wrapper-col-style":{overflowY:"auto"}},{default:c((()=>[m(y,{modelValue:n(q).content,"onUpdate:modelValue":t[7]||(t[7]=e=>n(q).content=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title"])}}});export{w as _,y as d,b as g};
