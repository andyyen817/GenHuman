import{g as e,s as a}from"./role-CkgbUrPW.js";import{d as l,M as t,f as s,c as d,g as o,o as i,a as u,w as r,j as m,i as c,H as n,$ as f}from"./index-PFxU9JJn.js";import{u as p}from"./useResetReactive-C9BdlN97.js";const v=l({__name:"AddRoleModal",emits:["save-success"],setup(l,{expose:v,emit:h}){const w=h,b=t("formRef"),V=s(""),x=d((()=>!!V.value)),_=d((()=>x.value?"编辑角色":"新增角色")),g=s(!1),[k,R]=p({title:"",code:"",status:1,description:""}),y={title:[{required:!0,message:"请输入角色名称"},{min:3,max:10,message:"长度在 3 - 10个字符"}],code:[{required:!0,message:"请输入角色编码"},{match:/^[a-zA-Z][a-zA-Z0-9_]*$/,message:"格式不对！只能英文开头，包含英文数字下划线"}],status:[{required:!0}]},j=()=>{var e;null==(e=b.value)||e.resetFields(),R()},M=async()=>{var e;try{if(await(null==(e=b.value)?void 0:e.validate()))return!1;return!!(await a(k))&&(f.success("保存成功"),w("save-success"),!0)}catch(l){return!1}};return v({add:()=>{V.value="",g.value=!0},edit:async a=>{g.value=!0,V.value=a;const l=await e({id:a});Object.assign(k,l.data)}}),(e,a)=>{const l=o("a-input"),t=o("a-form-item"),s=o("a-textarea"),d=o("a-switch"),f=o("a-form"),p=o("a-modal");return i(),u(p,{visible:c(g),"onUpdate:visible":a[4]||(a[4]=e=>n(g)?g.value=e:null),title:c(_),width:"90%","mask-closable":!1,"modal-style":{maxWidth:"520px"},onBeforeOk:M,onClose:j},{default:r((()=>[m(f,{ref_key:"formRef",ref:b,model:c(k),rules:y,size:"medium","auto-label-width":""},{default:r((()=>[m(t,{label:"角色名称",field:"title"},{default:r((()=>[m(l,{modelValue:c(k).title,"onUpdate:modelValue":a[0]||(a[0]=e=>c(k).title=e),modelModifiers:{trim:!0},placeholder:"请输入角色名称","allow-clear":""},null,8,["modelValue"])])),_:1}),m(t,{label:"角色编码",field:"code"},{default:r((()=>[m(l,{modelValue:c(k).code,"onUpdate:modelValue":a[1]||(a[1]=e=>c(k).code=e),modelModifiers:{trim:!0},placeholder:"请输入角色编码","allow-clear":"",disabled:c(x)},null,8,["modelValue","disabled"])])),_:1}),m(t,{label:"描述",field:"description"},{default:r((()=>[m(s,{modelValue:c(k).description,"onUpdate:modelValue":a[2]||(a[2]=e=>c(k).description=e),modelModifiers:{trim:!0},placeholder:"请填写描述","max-length":200,"show-word-limit":"","auto-size":{minRows:3,maxRows:5}},null,8,["modelValue"])])),_:1}),m(t,{label:"状态",field:"status"},{default:r((()=>[m(d,{modelValue:c(k).status,"onUpdate:modelValue":a[3]||(a[3]=e=>c(k).status=e),type:"round","checked-value":1,"unchecked-value":0,"checked-text":"正常","unchecked-text":"禁用"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title"])}}});export{v as _};
